# TIL | 2025.03.29

### ì˜¤ëŠ˜ ì§„í–‰ ìˆœì„œ ì˜ˆì •

> íŒ¨í„´ìœ¼ë¡œ ì½íˆê³  ì„¤ê³„ë¡œ ì™„ì„±í•˜ëŠ” ë¦¬ì•¡íŠ¸ -> ì£¼ì‹œ íšŒì˜ -> ì£¼ì‹œ ì‘ì—… -> ìŠ¤ë§ˆê²Œ ì‘ì—… -> ì•Œê³ ë¦¬ì¦˜

## ğŸ“Œ TIL ìš”ì•½

### ì•Œê³ ë¦¬ì¦˜

-   []ì •ë ¬ê³¼ ê·¸ë¦¬ë”” ê²°ì • ì•Œê³ ë¦¬ì¦˜ 10 ~ 12

### ì†Œì¼“ ì ìš©

-   [x]]í˜„ì¬ ì‘ì„±í•œ ë¡œì§ ë‹¤ì‹œ í•œë²ˆ ìƒê°(ì§„í–‰ì¤‘)

    -   ì‹±ê¸€í†¤ìœ¼ë¡œ ìœ ì¼ì„±ë§Œ ë³´ì¥í•˜ê³  storeì—ì„œ ì†Œì¼“ì„ ê´€ë¦¬í•´ì•¼í•˜ë‚˜ë¼ëŠ” ê³ ë¯¼ì¤‘
    -   í”¼ë“œë°± ì½ê³  ê³µë¶€ ë° ë°˜ì˜

-   [x]ì˜ˆì™¸ì²˜ë¦¬ ìƒê°

    -   [x] ë§Œì•½ ì†Œìº£ ì—°ê²°ì´ ì‹¤íŒ¨í•¨ë‹¤ë©´ : REST APIë¡œ ìš”ì²­ ë³´ë‚´ê¸°

-   [pr ì£¼ì†Œ](https://github.com/dev-4-team/eye-on-frontend/pull/40)
    -   í”¼ë“œë°± ë° ë‚´ í”¼ë“œë°±ì—ëŒ€í•œ ë‚´ ìƒê°

# ìŠ¤ë§ˆê²Œ

## ConfirmEmailPage ë¦¬íŒ©í† ë§í•˜ê¸°

### ë¦¬íŒ©í† ë§ ì§„í–‰í•˜ê¸°

#### 1. **ë¡œì§ ë¶„ë¦¬**

-   [x] ê° ë‹¨ê³„(API í˜¸ì¶œ)ì˜ **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì»´í¬ë„ŒíŠ¸ ë°–ìœ¼ë¡œ ë¶„ë¦¬**í•˜ì—¬ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•˜ê²Œ ë¦¬íŒ©í† ë§

-   [x] `postConfirmEmail`, `postSignIn`, `postLogin`, `postSignUp` í˜¸ì¶œ íë¦„ì„ **ëª…í™•íˆ ë¶„ë¦¬**
-   [] ë°˜ë³µë˜ëŠ” ë¡œì§ì€ ê³µí†µ ìœ í‹¸ì´ë‚˜ í›…ìœ¼ë¡œ ì¶”ìƒí™” (ì§„í–‰ì¤‘)

#### 2. **React Query ì ìš©**

-   [] `useMutation`, `mutate`, `mutateAsync`ë“± ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì˜ ì—­í• ì„ ëª…í™•íˆ êµ¬ë¶„í•˜ì—¬ ì‚¬ìš©

#### 3. **í† í° ì €ì¥ ë¡œì§ ê³ ë¯¼**

-   [] ë‹¨ìˆœí•œ í† í° ì €ì¥/ì´ˆê¸°í™”ëŠ” ìœ í‹¸ í•¨ìˆ˜ë¡œ ë¶„ë¦¬í•´ì•¼í•˜ë‚˜

---

### ê³ ë¯¼ ì¤‘ì¸ ë¶€ë¶„

-   [] **íšŒì›ê°€ì…/ë¡œê·¸ì¸ íë¦„ í†µí•© ì—¬ë¶€**

    -   ë°±ì—”ë“œê°€ ì„¤ê³„í•´ë‘” ë¡œì§ì„ ë‚´ê°€ ë°”ê¾¸ê¸´ ì–´ë ¤ìš´ìƒí™© íšŒì›ê°€ì…í•˜ê³  ë¡œê·¸ì¸ì€ ê·¸ëƒ¥ ìœ ì €ë¥¼ ì„œë²„ì— ë“±ë¡í•˜ëƒ ì°¨ì´ë°–ì— ì—†ê¸°ì— ë¶„ë¦¬í•  ì˜ˆì •(ê·¼ë° ì–´ë–»ê²Œ ì´ì˜ê²Œ? í…ŒìŠ¤íŠ¸ ìš©ì´í•˜ê²Œ?)

-   [] **ì˜ˆì™¸ ì²˜ë¦¬ ë°©í–¥**

    -   ëª¨ë“  ì¸ì¦ ë‹¨ê³„(postConfirmEmail, postSignIn, postLogin, postSignUp) ì¤‘ í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ì „ì²´ íë¦„ ì¤‘ë‹¨(3ê°€ì§€ì¤‘ í•˜ë‚˜ë¼ë„ ì•ˆë˜ë©´ ì–´ì°¨í”¼ ì„œë¹„ìŠ¤ ì‚¬ìš© ë¶ˆê°€)
    -   ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ìì—ê²Œ **toast ì•Œë¦¼**ì„ ë„ìš°ê³ , ì•ˆë‚´ ë©”ì‹œì§€ ë˜ëŠ” â€œë¬¸ì˜í•˜ê¸°â€ ë²„íŠ¼ ì œê³µ ê³ ë ¤ ì¤‘

-   [] **ë¡œë”© ì²˜ë¦¬ ë° ì—ëŸ¬**
    -   ì „ì²´ì ì¸ ì˜ˆì™¸ì²˜ë¦¬ ë¶€ì¡±
        -   ë¡œë”©
        -   ì—ëŸ¬

---

# íŒ¨í„´ìœ¼ë¡œ ìµíˆê³  ì„¤ê³„ë¡œ ì™„ì„±í•˜ëŠ” ë¦¬ì•¡íŠ¸

-   ch4 ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ ì„¤ê³„í•˜ê¸° ~

# ğŸ“Œ TIL ìƒì„¸

## ì•Œê³ ë¦¬ì¦˜

-   ì •ë ¬ê³¼ ê·¸ë¦¬ë”” ê²°ì • ì•Œê³ ë¦¬ì¦˜
    -   10
    -   11
    -   12

## ì†Œì¼“ ì ìš©

-   í˜„ì¬ ì‘ì„±í•œ ë¡œì§

    -   í”¼ë“œë°± ì½ê³  ê³µë¶€ ë° ë°˜ì˜

### í”¼ë“œë°± ë‚´ìš©

> 1.  ì¶”ìƒí™” ê³„ì¸µ(interface) : socket í´ë˜ìŠ¤ë¥¼ ì“°ëŠ” ì…ì¥ì—ì„  socketì˜ ì¢…ë¥˜ì— ìƒê´€ì—†ì´ ì¼ê´€ì„± ìˆê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
> 2.  ì†Œì¼“ ê´€ë ¨ ë©”ì†Œë“œëŠ” ëª¨ë‘ ì†Œì¼“ classì—ì„œ ê´€ë¦¬í•´ì•¼ í•œë‹¤.(ì‘ì§‘ì„± ë†’ì€ ì½”ë“œ)
> 3.  ì—°ê²° ê´€ë¦¬ì— ì„¸ì‹¬í•œ ì£¼ì˜ê°€ í•„ìš”í•˜ë‹¤. ë§Œì•½ ë¡œì»¬ ìŠ¤í…Œì´íŠ¸ë¡œ ê´€ë¦¬í–ˆë‹¤ë©´ ì»´í¬ë„ŒíŠ¸ unmountì‹œ ìì—°ìŠ¤ëŸ½ê²Œ ë¶ˆí•„ìš”í•œ ìì›ì´ ì •ë¦¬ë  ìˆ˜ ìˆì—ˆì§€ë§Œ,
>     ì „ì—­ìœ¼ë¡œ ê´€ë¦¬ ì‹œ, ì†Œì¼“ì˜ í† í”½ êµ¬ë… ,êµ¬ë… í•´ì œ, ì—°ê²°ë“±ì„ ì»´í¬ë„ŒíŠ¸ ë¼ì´í”„ ì‹¸ì´í´ì— ë§ê²Œ ì§ì ‘ ê´€ë¦¬ë¥¼ í•´ì¤˜ì•¼í•œë‹¤.
> 4.  ë³´í†µ socket ìì› ê´€ë¦¬ëŠ” best practiceë¥¼ ì°¸ê³ í•˜ëŠ”ê²Œ ì¢‹ì€ ê²ƒ ê°™ë‹¤. ë§ì€ ìœ ì‚¬ ì„œë¹„ìŠ¤ë“¤ì€ socket ìì› ê´€ë¦¬ë¥¼ ì–´ë–¤ ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ”ì§€ ë´ë´ë¼

### í”¼ë“œë°± ì´í›„ 2ì°¨ ìˆ˜ì •

```ts
export class StompSocket implements ISocket {
    private static instance: StompSocket;
    private client: StompJs.Client | null = null;
    private subscriptions: Map<string, StompJs.StompSubscription> = new Map();

    private constructor() {}

    public static getInstance() {
        if (!StompSocket.instance) {
            StompSocket.instance = new StompSocket();
        }
        return StompSocket.instance;
    }

    public connect() {
        return new Promise<boolean>((resolve, reject) => {
            this.client = new StompJs.Client({
                webSocketFactory: () => SockJS(`${SERVER_URL}/api/ws`),
            });
            this.client.onConnect = () => {
                console.log('socket ì—°ê²° ì„±ê³µ');
                resolve(true);
            };
            this.client.onStompError = (error) => {
                console.log('socket ì—°ê²° ì‹¤íŒ¨', error);
                reject(error);
            };
            this.client.activate();
        });
    }

    public disconnect() {
        if (!this.isConnected()) return;
        this.subscriptions.forEach((subscription) => subscription.unsubscribe());
        this.subscriptions.clear();
        this.client?.deactivate();
    }

    public join(topic: string, callback: (message: StompJs.IFrame) => void) {
        if (!this.isConnected()) return;
        if (!this.subscriptions.has(topic)) {
            const subscribe = this.client?.subscribe(topic, callback);
            if (subscribe) this.subscriptions.set(topic, subscribe);
        }
    }

    public leave(topic: string) {
        if (!this.isConnected()) return;
        if (this.subscriptions.has(topic)) {
            this.subscriptions.get(topic)?.unsubscribe();
            this.subscriptions.delete(topic);
        }
    }

    public sendMessage(topic: string, message?: string) {
        if (!this.isConnected()) return;
        this.client?.publish({
            destination: topic,
            body: message ? message : undefined,
        });
    }

    private isConnected() {
        return this.client?.connected ?? false;
    }
}

export const stompSocket = StompSocket.getInstance();
```

```ts
import { create } from 'zustand';
import { StompSocket } from '@/lib/socket';
import { IFrame } from '@stomp/stompjs';

interface SocketStore {
    isStompSocketIsReady: boolean;
    connect: () => void;
    disconnect: () => void;
    subscribe: (topic: string, callback: (message: IFrame) => void) => void;
    publish: (topic: string, message?: string | undefined) => void;
}

export const useSocketStore = create<SocketStore>()((set, get) => ({
    isStompSocketIsReady: false,
    connect: async () => {
        try {
            await StompSocket.getInstance().connect();
            set({ isStompSocketIsReady: true });
        } catch (e) {
            set({ isStompSocketIsReady: false });
            console.log('ì—ìƒì¹˜ ëª»í•œ ì†Œì¼“ ì—°ê²° ì—ëŸ¬', e);
            throw e;
        }
    },
    disconnect: () => {
        StompSocket.getInstance().disconnect();
        set({ isStompSocketIsReady: false });
    },
    subscribe: (topic, callback) => {
        StompSocket.getInstance().join(topic, callback);
    },
    publish: (topic: string, message: string | undefined) => {
        StompSocket.getInstance().sendMessage(topic, message);
    },
}));
```

---

### 2ì°¨ ìˆ˜ì • ë‚´ìš© ë¶„ì„ ë° ë³´ì™„ ê³„íš

#### í˜„ì¬ ìƒí™© ìƒì„¸ ë¶„ì„

1. ì²« ìˆ˜ì • ì‹œë„ì˜ í•œê³„

    - StompSocket í´ë˜ìŠ¤ ë‚´ë¶€ì˜ êµ¬ë… ê´€ë¦¬ ë¡œì§ë§Œ ê°•í™”
    - ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€ë¥¼ ìœ„í•œ subscription ê´€ë¦¬ ì¶”ê°€
    - í•˜ì§€ë§Œ ì´ëŠ” í‘œë©´ì ì¸ ìˆ˜ì •ì— ê·¸ì¹¨
    - ì—¬ì „íˆ Stompì— ê°•í•˜ê²Œ ê²°í•©ëœ êµ¬ì¡° ìœ ì§€

2. ë†“ì¹œ í•µì‹¬ ìš”êµ¬ì‚¬í•­
    - ì¶”ìƒí™” ê³„ì¸µ ë„ì…ì„ í†µí•œ ìœ ì—°ì„± í™•ë³´
    - ì†Œì¼“ ë¼ì´ë¸ŒëŸ¬ë¦¬ êµì²´ ê°€ëŠ¥ì„± ê³ ë ¤
    - ì‚¬ìš©í•˜ëŠ” ìª½ê³¼ êµ¬í˜„ì²´ì˜ ëª…í™•í•œ ë¶„ë¦¬

### ë°œê²¬ëœ ë¬¸ì œì  ìƒì„¸

-   Stomp êµ¬í˜„ì²´ì— ì§ì ‘ ì˜ì¡´

    ```typescript
    // ë¬¸ì œê°€ ìˆëŠ” í˜„ì¬ ì½”ë“œ
    import { StompSocket } from '@/lib/socket';
    import { IFrame } from '@stomp/stompjs'; // Stomp íŠ¹í™” íƒ€ì… ì§ì ‘ ì‚¬ìš©

    interface SocketStore {
        isStompSocketIsReady: boolean; // Stomp íŠ¹í™” ë„¤ì´ë°
        subscribe: (topic: string, callback: (message: IFrame) => void) => void;
    }
    ```

-   êµ¬ë… ê´€ë¦¬ ë¯¸í¡
    ```typescript
    useEffect(() => {
        subscribe('/topic/chat', handleMessage);
        // êµ¬ë… í•´ì œ ë¡œì§ ë¶€ì¬
        return () => disconnect(); // ì§ì ‘ì ì¸ ì—°ê²° ì¢…ë£Œë§Œ
    }, []);
    ```

#### ì¶”ìƒí™”ì— ëŒ€í•œ ê¹Šì€ ì´í•´

1. ì‚¬ìš©í•˜ëŠ” ìª½ì˜ ë¶ˆë³€ì„±ì´ë€?

    ```typescript
    // ì´ìƒì ì¸ ì‚¬ìš© ì½”ë“œ
    const socket: ISocket = getSocket(); // ì–´ë–¤ êµ¬í˜„ì²´ë“  ìƒê´€ì—†ìŒ

    // í•­ìƒ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©
    socket.connect();
    socket.subscribe(topic, callback);
    socket.publish(topic, message);
    ```

2. ì¶”ìƒí™” ê³„ì¸µì˜ ì‹¤ì œ ì˜ë¯¸

    - êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ ì€ë‹‰

    ```typescript
    // ì¶”ìƒí™” ê³„ì¸µ (ì¸í„°í˜ì´ìŠ¤)
    interface ISocket {
        connect(): Promise<void>;
        subscribe(topic: string, callback: (message: any) => void): void;
        publish(topic: string, message: any): void;
        // ... ê¸°íƒ€ í•„ìš”í•œ ë©”ì„œë“œë“¤
    }

    // Stomp êµ¬í˜„ì²´
    class StompSocket implements ISocket {
        // Stomp íŠ¹í™” êµ¬í˜„
    }

    // Socket.io êµ¬í˜„ì²´
    class SocketIOAdapter implements ISocket {
        // Socket.io íŠ¹í™” êµ¬í˜„
    }
    ```

#### ì‹¤ì œ ì ìš© ì‹œ ë†“ì¹œ ë¶€ë¶„ë“¤

1. ì¸í„°í˜ì´ìŠ¤ ì„¤ê³„

    - ê³µí†µ ê¸°ëŠ¥ë§Œ ì¶”ì¶œí•˜ì§€ ì•ŠìŒ
    - íŠ¹ì • êµ¬í˜„ì²´(Stomp)ì— ì¢…ì†ëœ ì¸í„°í˜ì´ìŠ¤ ì„¤ê³„

2. ì˜ì¡´ì„± ì£¼ì…

    - êµ¬í˜„ì²´ë¥¼ ì§ì ‘ ì°¸ì¡°í•˜ëŠ” ëŒ€ì‹  ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•œ ì°¸ì¡° í•„ìš”

    ```typescript
    // ìˆ˜ì • ì „ ë°©ì‹
    const socket = StompSocket.getInstance();

    // ìˆ˜ì • í›„ ë°©ì‹
    const socket: ISocket = socket.create();
    ```

3. ì—ëŸ¬ ì²˜ë¦¬ ë° ìƒíƒœ ê´€ë¦¬
    - êµ¬í˜„ì²´ íŠ¹í™”ëœ ì—ëŸ¬ ì²˜ë¦¬
    - ì—°ê²° ìƒíƒœ ê´€ë¦¬ì˜ ì¼ê´€ì„± ë¶€ì¡±

#### ë‹¤ìŒ ë‹¨ê³„ë¥¼ ìœ„í•œ êµ¬ì²´ì  ê³„íš

1. ì¸í„°í˜ì´ìŠ¤ ì¬ì„¤ê³„

    - ê³µí†µ ê¸°ëŠ¥ ì¶”ì¶œ
    - êµ¬í˜„ì²´ ë…ë¦½ì ì¸ íƒ€ì… ì •ì˜
    - ëª…í™•í•œ ê³„ì•½ ì •ì˜

2. êµ¬í˜„ì²´ ë¶„ë¦¬

    - Stomp êµ¬í˜„ì²´ë¥¼ ë³„ë„ íŒŒì¼ë¡œ ë¶„ë¦¬
    - í–¥í›„ ë‹¤ë¥¸ êµ¬í˜„ì²´ ì¶”ê°€ ìš©ì´í•˜ê²Œ ì„¤ê³„
    - ì˜ì¡´ì„± ì£¼ì… ìš©ì´í•˜ê²Œ ì„¤ê³„

-   ì˜ˆì™¸ì²˜ë¦¬ ìƒê°
    -   ë§Œì•½ ì†Œìº£ ì—°ê²°ì´ ì‹¤íŒ¨í–ˆì„ë•Œ REST APIë¡œ ìš”ì²­ ê°€ëŠ¥í•˜ê²Œ ìˆ˜ì •í•˜ê¸°

## 3ì°¨ ìˆ˜ì • ë‚´ìš© ë¶„ì„ ë° ë³´ì™„ ê³„íš

### 2ì°¨ ìˆ˜ì •ë³¸

1. Stomp ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì§ì ‘ì ìœ¼ë¡œ ì˜ì¡´
2. êµ¬ë… ê´€ë¦¬ ë¡œì§ ë¶€ì¬
3. ë©”ì„œë“œ ì´ë¦„ì˜ ì¼ê´€ì„± ë¶€ì¡±
4. íƒ€ì… ì•ˆì „ì„± ë¶€ì¡±

## í•´ê²° ê³¼ì •

### 1. ì¶”ìƒí™” ê³„ì¸µ ë„ì…

```typescript
// ì¸í„°í˜ì´ìŠ¤ ì •ì˜
export interface ISocket {
    connect: () => Promise<boolean>;
    disconnect: () => void;
    join: (topic: string, callback: (message: unknown) => void) => void;
    leave: (topic: string) => void;
    sendMessage: (topic: string, message?: string) => void;
}

// Stomp êµ¬í˜„ì²´
export class StompSocket implements ISocket {
    private static instance: StompSocket;
    private client: StompJs.Client | null = null;
    private subscriptions: Map<string, StompJs.StompSubscription> = new Map();

    // ... êµ¬í˜„
}
```

**ê°œì„ ì :**

-   ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•œ êµ¬í˜„ì²´ ë¶„ë¦¬
-   ë‹¤ë¥¸ ì†Œì¼“ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ êµì²´ ê°€ëŠ¥í•œ êµ¬ì¡°
-   êµ¬ë… ê´€ë¦¬ë¥¼ ìœ„í•œ Map ë„ì…

### 2. ì¤‘ì•™ ìƒíƒœ ê´€ë¦¬ ë„ì…

```typescript
interface SocketStore {
    socketIsReady: boolean;
    socket: ISocket;
    connect: () => void;
    disconnect: () => void;
    join: (topic: string, callback: (message: unknown) => void) => void;
    sendMessage: (topic: string, message?: string) => void;
}

export const useSocketStore = create<SocketStore>()((set, get) => ({
    socketIsReady: false,
    socket: StompSocket.getInstance(),
    // ... êµ¬í˜„
}));
```

**ê°œì„ ì :**

-   ì†Œì¼“ ìƒíƒœì˜ ì¤‘ì•™ ê´€ë¦¬
-   ì»´í¬ë„ŒíŠ¸ ê°„ ì†Œì¼“ ìƒíƒœ ê³µìœ 
-   ì—°ê²° ìƒíƒœ ì¶”ì  ê°€ëŠ¥

### 3. êµ¬ë… ê´€ë¦¬ ê°œì„ 

```typescript
export class StompSocket implements ISocket {
    private subscriptions: Map<string, StompJs.StompSubscription> = new Map();

    public disconnect() {
        if (!this.isConnected()) return;
        this.subscriptions.forEach((subscription) => subscription.unsubscribe());
        this.subscriptions.clear();
        this.client?.deactivate();
    }

    public join(topic: string, callback: (message: unknown) => void) {
        if (!this.isConnected()) return;
        if (!this.subscriptions.has(topic)) {
            const subscribe = this.client?.subscribe(topic, callback);
            if (subscribe) this.subscriptions.set(topic, subscribe);
        }
    }
}
```

**ê°œì„ ì :**

-   êµ¬ë… ê°ì²´ ì¶”ì  ë° ê´€ë¦¬
-   ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€
-   ì¤‘ë³µ êµ¬ë… ë°©ì§€

## ê²°ê³¼

### 1. ì½”ë“œ êµ¬ì¡° ê°œì„ 

-   ê´€ì‹¬ì‚¬ ë¶„ë¦¬ë¥¼ í†µí•œ ì½”ë“œ êµ¬ì¡°í™”
-   ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ ì„¤ê³„ë¡œ ìœ ì—°ì„± í™•ë³´
-   ìƒíƒœ ê´€ë¦¬ ë¡œì§ ì¤‘ì•™í™”

### 2. ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ

```typescript
// ë‹¤ë¥¸ ì†Œì¼“ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì ìš© ì‹œ
class SocketIOAdapter implements ISocket {
    // Socket.IO êµ¬í˜„
}
```

-   ìƒˆë¡œìš´ ì†Œì¼“ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë„ì…ì´ ìš©ì´
-   ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ì—†ì´ í™•ì¥ ê°€ëŠ¥

### 3. ì•ˆì •ì„± ê°œì„ 

```typescript
public join(topic: string, callback: (message: unknown) => void) {
    if (!this.isConnected()) return;
    // êµ¬ë… ê´€ë¦¬ ë¡œì§
}

public disconnect() {
    // ëª¨ë“  êµ¬ë… í•´ì œ ë³´ì¥
    this.subscriptions.forEach((subscription) => subscription.unsubscribe());
}
```

-   êµ¬ë… ëˆ„ìˆ˜ ë°©ì§€
-   ì—°ê²° ìƒíƒœ ì¶”ì 
-   ì—ëŸ¬ ìƒí™© ì²˜ë¦¬

#### 3ì°¨ ìˆ˜ì • ì ìš©

```ts
export class StompSocket implements ISocket {
    private static instance: StompSocket;
    private client: StompJs.Client | null = null;
    private subscriptions: Map<string, StompJs.StompSubscription> = new Map();

    private constructor() {}

    public static getInstance() {
        if (!StompSocket.instance) {
            StompSocket.instance = new StompSocket();
        }
        return StompSocket.instance;
    }

    public connect() {
        return new Promise<boolean>((resolve, reject) => {
            this.client = new StompJs.Client({
                webSocketFactory: () => SockJS(`${SERVER_URL}/api/ws`),
            });
            this.client.onConnect = () => {
                console.log('socket ì—°ê²° ì„±ê³µ');
                resolve(true);
            };
            this.client.onStompError = (error) => {
                console.log('socket ì—°ê²° ì‹¤íŒ¨', error);
                reject(error);
            };
            this.client.activate();
        });
    }

    public disconnect() {
        if (!this.isConnected()) return;
        this.subscriptions.forEach((subscription) => subscription.unsubscribe());
        this.subscriptions.clear();
        this.client?.deactivate();
    }

    public join(topic: string, callback: (message: StompJs.IFrame) => void) {
        if (!this.isConnected()) return;
        if (!this.subscriptions.has(topic)) {
            const subscribe = this.client?.subscribe(topic, callback);
            if (subscribe) this.subscriptions.set(topic, subscribe);
        }
    }

    public leave(topic: string) {
        if (!this.isConnected()) return;
        if (this.subscriptions.has(topic)) {
            this.subscriptions.get(topic)?.unsubscribe();
            this.subscriptions.delete(topic);
        }
    }

    public sendMessage(topic: string, message?: string) {
        if (!this.isConnected()) return;
        this.client?.publish({
            destination: topic,
            body: message ? message : undefined,
        });
    }

    private isConnected() {
        return this.client?.connected ?? false;
    }
}

export const stompSocket = StompSocket.getInstance();
```

### ì¶”ìƒí™” ê³„ì¸µ ë„ì…

```ts
export interface ISocket {
    connect: () => Promise<boolean>;
    disconnect: () => void;
    join: (topic: string, callback: (message: unknown) => void) => void;
    leave: (topic: string) => void;
    sendMessage: (topic: string, message?: string | undefined) => void;
}
```

### ì¤‘ì•™ ìƒíƒœ ê´€ë¦¬ ë„ì…

```ts
import { create } from 'zustand';
import { StompSocket } from '@/lib/socket';
import { ISocket } from '@/lib/ISoket';

interface SocketStore {
    socketIsReady: boolean;
    socket: ISocket;
    connect: () => void;
    disconnect: () => void;
    join: (topic: string, callback: (message: unknown) => void) => void;
    sendMessage: (topic: string, message?: string | undefined) => void;
}

export const useSocketStore = create<SocketStore>()((set, get) => ({
    socketIsReady: false,
    socket: StompSocket.getInstance(),
    connect: async () => {
        try {
            await get().socket.connect();
            set({ socketIsReady: true });
        } catch (e) {
            set({ socketIsReady: false });
            console.log('ì—ìƒì¹˜ ëª»í•œ ì†Œì¼“ ì—°ê²° ì—ëŸ¬', e);
            throw e;
        }
    },
    disconnect: () => {
        get().socket.disconnect();
        set({ socketIsReady: false });
    },
    join: (topic, callback) => {
        get().socket.join(topic, callback);
    },
    sendMessage: (topic: string, message: string | undefined) => {
        get().socket.sendMessage(topic, message);
    },
}));
```

## ìŠ¤ë§ˆê²Œ

### ConfirmEmailPage ë¦¬íŒ©í† ë§í•˜ê¸°

### ê¸°ì¡´ ë¬¸ì œì 

-   ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ API í˜¸ì¶œë¶€ ì•ˆì— ì„ì—¬ ìˆì–´ **ì—­í•  ë¶„ë¦¬ê°€ ë˜ì§€ ì•ŠìŒ**
-   ì—¬ëŸ¬ ê¸°ëŠ¥(ë¡œê·¸ì¸/íšŒì›ê°€ì…/ì´ë©”ì¼ ì¸ì¦)ì„ **í•˜ë‚˜ì˜ í•¨ìˆ˜ë¡œ ì²˜ë¦¬**í•˜ë ¤ í•˜ë©´ì„œ, **ê´€ë ¨ ì—†ëŠ” ë¡œì§ë„ í•¨ê»˜ ìˆ˜í–‰**
-   ê°™ì€ APIë¥¼ **ì¤‘ë³µ í˜¸ì¶œ**í•˜ê±°ë‚˜ ë¶ˆí•„ìš”í•˜ê²Œ ì—°ê²°ëœ êµ¬ì¡°
-   ì˜ˆì™¸ ì²˜ë¦¬ ë¡œì§ì´ ì—†ì–´, ì˜¤ë¥˜ ë°œìƒ ì‹œ **ì‚¬ìš©ì í”¼ë“œë°±ì´ ë¶ˆê°€ëŠ¥**
-   ë¡œì§ í…ŒìŠ¤íŠ¸ê°€ ì–´ë ¤ì›Œ ìœ ì§€ë³´ìˆ˜ì„± ë° í™•ì¥ì„±ì´ ë–¨ì–´ì§
-   ê¸°ì¡´ ë¡œì§
-   <img width="951" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-03-31 á„‹á…©á„Œá…¥á†« 1 00 50" src="https://github.com/user-attachments/assets/d03c8bf6-c7a8-4ff8-b2e4-5614904bdd66" />
-   1ì°¨ ìˆ˜ì • í›„ ë¡œì§
-   <img width="848" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-03-31 á„‹á…©á„Œá…¥á†« 1 02 21" src="https://github.com/user-attachments/assets/9d28f638-e045-463e-9b75-4263f290483c" />
-   ë‚˜ë¨¸ì§€ ë¡œì§ì€ ë°±ì—”ë“œ ë¡œì§ì´ ê·¸ëŸ¬í•˜ì—¬ ë”ì´ìƒ ìˆ˜ì • ë¶ˆê°€ í•¨ ìµœëŒ€í•œ ë¶ˆí•„ìš”í•œ api ìš”ì²­ê³¼ ì½”ë“œì‹¤í–‰ì„ ì¤„ì´ê³  ìœ ì§€ë³´ìˆ˜ë‚˜ í…ŒìŠ¤íŠ¸ê°€ ìš©ì´í•˜ê²Œ í•˜ëŠ”ê²ƒ ë§ê³ ëŠ” ì—†ì—ˆìŒ

### ë¦¬íŒ©í† ë§ ë°©í–¥

#### 1. **ë¡œì§ ë¶„ë¦¬**

-   [] ë°˜ë³µë˜ëŠ” ë¡œì§ì€ ê³µí†µ ìœ í‹¸ì´ë‚˜ í›…ìœ¼ë¡œ ì¶”ìƒí™” (ì§„í–‰ì¤‘)

#### 2. **React Query ì ìš©**

-   [] `useMutation`, `mutate`, `mutateAsync`ì˜ ì—­í• ì„ ëª…í™•íˆ êµ¬ë¶„í•˜ì—¬ ì‚¬ìš©
    -   `mutate`: ì½œë°± ì¤‘ì‹¬ ì²˜ë¦¬ (ë¹ ë¥¸ í”¼ë“œë°±)
    -   `mutateAsync`: async/await ë¬¸ë²•ê³¼ ì–´ìš¸ë ¤ **ê°€ë…ì„± ë° ì—ëŸ¬ ì²˜ë¦¬ ìš©ì´**

#### 3. **í† í° ì €ì¥ ë¡œì§ ê³ ë¯¼**

-   [] ë‹¨ìˆœí•œ í† í° ì €ì¥/ì´ˆê¸°í™”ëŠ” ìœ í‹¸ í•¨ìˆ˜ë¡œ ë¶„ë¦¬í•´ì•¼í•˜ë‚˜

---

### ê³ ë¯¼ ì¤‘ì¸ ë¶€ë¶„

-   **íšŒì›ê°€ì…/ë¡œê·¸ì¸ íë¦„ í†µí•© ì—¬ë¶€**

    -   ë°±ì—”ë“œê°€ ì„¤ê³„í•´ë‘” ë¡œì§ì„ ë‚´ê°€ ë°”ê¾¸ê¸´ ì–´ë ¤ìš´ìƒí™© íšŒì›ê°€ì…í•˜ê³  ë¡œê·¸ì¸ì€ ê·¸ëƒ¥ ìœ ì €ë¥¼ ì„œë²„ì— ë“±ë¡í•˜ëƒ ì°¨ì´ë°–ì— ì—†ê¸°ì— ë¶„ë¦¬í•  ì˜ˆì •(ê·¼ë° ì–´ë–»ê²Œ ì´ì˜ê²Œ? í…ŒìŠ¤íŠ¸ ìš©ì´í•˜ê²Œ?)

-   **ì˜ˆì™¸ ì²˜ë¦¬ ë°©í–¥**

    -   ëª¨ë“  ì¸ì¦ ë‹¨ê³„(postConfirmEmail, postSignIn, postLogin, postSignUp) ì¤‘ í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ì „ì²´ íë¦„ ì¤‘ë‹¨(3ê°€ì§€ì¤‘ í•˜ë‚˜ë¼ë„ ì•ˆë˜ë©´ ì–´ì°¨í”¼ ì„œë¹„ìŠ¤ ì‚¬ìš© ë¶ˆê°€)
    -   ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ìì—ê²Œ **toast ì•Œë¦¼**ì„ ë„ìš°ê³ , ì•ˆë‚´ ë©”ì‹œì§€ ë˜ëŠ” â€œë¬¸ì˜í•˜ê¸°â€ ë²„íŠ¼ ì œê³µ ê³ ë ¤ ì¤‘

-   **ë¡œë”© ì²˜ë¦¬ ë° ì—ëŸ¬** (í˜„ì¬ ì²˜ë¦¬ì¤‘ì¸ ì‘ì—… ê¸°ì¤€)
    -   ì´ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨ì‹œ
    -   ë¡œê·¸ì¸ ì‹¤íŒ¨ì‹œ
    -   íšŒì›ê°€ì… ì‹¤íŒ¨ì‹œ
    -   ì´ë©”ì¼ ì¸ì¦ ì‹¤íŒ¨ì‹œ
