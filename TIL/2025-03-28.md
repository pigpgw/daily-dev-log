# TIL | 2025.03.28

## 📌 TIL 요약

### 알고리즘

-   정렬과 그리디 결정 알고리즘 9

### 주시

### 응원하기 기능 구현

-   요구사항을 명확히 이해한다
    -   A 유저가 시위 상세 페이지에서 응원하기 버튼을 누르면 메인 화면에 있던 다른 B 유저의 화면에 A 유저가 누른 시위 위에 애니메이션이 일어나야하는 기능
-   사용자의 행동 흐름을 간단히 정리한다
    -   서비스 접속(메인 홈) -> 시위 상세 -> 응원하기 버튼 클릭
-   필요한 데이터와 상태 흐름을 정리한다
    -   우선 서비스 접속하자마자 소켓이 켜져야한다.
    -   소켓이 연결되면 상태 변경이 일어나야한다 그렇지 않으면 리엑트는 감지하지 못한다.
    -   현재는 context를 사용하여 소켓을 전달해 주었지만 디벨롭을 위해서 singleton과 zustand를 사용해 소켓 변화를 감지시켜 다룰려고한다.
-   UI 렌더링을 위한 로직인지, 아니면 비즈니스 로직(기능 흐름이나 데이터 처리에 필요한 로직인지) 구분한다.
    -   우선 화면위주보단 소켓 기능 자체를 리팩토링중이다.
-   API 요청 및 응답 흐름을 설계한다
    -   기존 로직은 소켓을 연결하자마자 응원하기 토픽과 에러 로깅을 위한 토픽을 구독하였는데 이 로직은 단일 책임 원칙을 위배한다고 생각되어 리팩토링을 진행할 예정이다.
-   예외 상황(빈값, 실패, 에러 등)을 예상하고 대응 방식을 고민한다
    -   소켓 연결 실패시 어떻게 사용자에게 제공할지 모르겠어서 공부할 예정이다.
-   전체 UI 구조와 컴포넌트 트리를 대략 그려본다
    -   우선 생략
-   공통 컴포넌트로 추출 가능한 부분을 검토한다
    -   그러기위해 기존에 context로 리팩토링을 하였고 현재는 zustand와 singleton 사용으로 디벨롭을 진행할 예정이다.
-   API 연동 및 성공/로딩/에러 처리를 구현한다
-   전체 플로우를 브라우저에서 테스트한다
-   엣지 케이스와 잘못된 입력을 체크하며 예외 처리를 보완한다
-   코드 역할 분리 및 구조 점검 후 리팩토링한다
    -   어찌 싱글톤은 구현을 했는데 책임 분리가 불명확했다.
        -   Singleton은 소켓 인스턴스 관리
        -   Zustand는 연결 상태 관리
        -   컴포넌트에서 구독 로직 처리
    -   더 나은 구조
        -   Zustand store에서 소켓 관련 모든 상태와 동작을 관리
        -   Singleton은 순수하게 소켓 인스턴스 관리만 담당
        -   구독 로직은 store나 별도 service로 분리
-   기능 단위 커밋과 PR을 작성하며 설명 가능한 구조로 정리한다

### 소켓 적용

-   singleton으로 분리 Stompjs 객체

    -   소켓 instance 생성시
        -   소켓 생성
    -   connect
        -   소켓 연결
    -   disconnect
        -   소켓 연결 제거(근데 연결 안됬을때 연결 해제를 사용하면 어떻게 예외처리하지)
    -   subscribe
        -   소켓 토픽 구독(근데 연결 안됬을때 구독을 사용하면 어떻게 예외처리하지)
    -   publish

-   모르는거

    -   activate는 실제 연결 시도를 시작하는 메소드
        -   연결 완료/실패 시점을 알려면 onConnect/onStompError 핸들러를 통해서 연결 시작이 아닌 연결이 완료되거나 실패한 지점에 다음 동작을 수행하게 함

-   채승이 구현 방식
    -   소켓 instance 및 rtc , yjs 소켓 class 를 따로 작성
    -   소켓 매니저에서 한번에 관리

### 스마게

-   비즈니스 로직이란 무엇인가 공부
-   우선 로그인 api 부분 비즈니스 로직 분리
-   에러처리
    -   페이지 일부분이 터졌을떄 UI 어떻게할지
        -   일부만 보여줄지
        -   안보여줄지
    -   로딩
        -   스켈레톤

### 개인 공부

### OOP

-   js class

    -   js class는 기존에 존재하던 javascript 위에 추가된 것이기 떄문에 완전히 새롭게 완벽하게 추가 된 것이 아니라 기존에 존재하던 prototype을 베이스로 한 것에 기반해서 그 위에 간편하게 쓸 수 있도록 문법만 class로 추가된 것 : 이런걸 syntatical sugar라고 함 (문법상으로 달달한 가짜의 편리함을 제공한다는 뜻)

    -   class가 있기 이전
        -   클래스 도입 이전에는 클래스를 정의하지 않고 바로 Object를 생성 가능했다 function을 사용해서
