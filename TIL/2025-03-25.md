# TIL | 2025.03.25

## 📌 TIL 요약

### 알고리즘

-   자료구조 (스택 큐 마무리 : 해설 강의 시청)
    -   4 ~ 7

### 주시

-   UI 작업 후 stomp 공부 및 코드 작성 (UI 피드백 받은 후)

# TIL 상세

## 알고리즘

-   자료구조 (스택 큐 마무리 : 해설 강의 시청)
    -   4 ~ 7

### 주시

## 🧠 STOMP 공부 및 적용 정리

### 📌 STOMP Protocol 이란?

-   **STOMP(Simple Text Oriented Messaging Protocol)**는 WebSocket 위에서 동작하는 **텍스트 기반의 메시징 프로토콜**이다.
-   클라이언트와 서버 간 **메시지의 유형, 형식, 내용**을 정의하는 규칙을 제공한다.
-   STOMP 메시지는 **헤더를 포함**할 수 있어, 이를 통해 인증 정보를 전달하는 등 **헤더 기반 통신 처리**가 가능하다.
-   STOMP 스펙만 지킨다면, **여러 언어 및 플랫폼 간 호환성** 있는 메시징이 가능하다.

> 쉽게 말해, WebSocket이 메시지를 전달하는 통신선이라면, STOMP는 그 선을 따라 어떤 형태로 메시지를 주고받을지 정하는 약속이다.

---

### 🔁 STOMP의 동작 구조

-   **양방향 통신** 기반 (WebSocket, TCP 등 위에서 동작)
-   기본적으로 **Text 기반 프로토콜**이지만, Payload에는 Text나 Binary 모두 가능
-   STOMP의 핵심은 **pub/sub(Publish-Subscribe)** 패턴 기반의 메시징

---

### 📬 pub/sub이란?

-   pub/sub은 메시지를 **발행하는 주체(Publisher)**와 **구독하는 주체(Subscriber)**를 분리하여 동작하는 방식이다.
-   발행자는 특정 주제(Topic)에 메시지를 보내고, 구독자는 그 Topic을 구독해 메시지를 수신한다.

#### 💡 채팅방 예시로 보는 pub/sub 구조

| 상황          | pub/sub 설명                                    |
| ------------- | ----------------------------------------------- |
| 채팅방 생성   | Topic 생성                                      |
| 유저 입장     | 해당 Topic 구독 (Subscribe)                     |
| 메시지 송수신 | Topic에 메시지 발행 (Publish) → 구독자에게 전달 |

> 구독자는 여러 명일 수 있어, **다자간 실시간 메시징 구현에 적합**하다.

---

## ⚙️ STOMP.js & SockJS

### ✅ STOMP.js란?

-   `STOMP.js`는 **JavaScript 환경에서 STOMP 프로토콜을 사용할 수 있도록 도와주는 라이브러리**다.
-   클라이언트는 이를 통해 서버와 WebSocket 연결을 만들고, 메시지를 구독/발행할 수 있다.
    -   메시지 Pub/Sub 담당
-   주요 기능:
    -   `client.subscribe()` → 메시지 구독
    -   `client.publish()` → 메시지 발행
-   WebSocket 주소는 `brokerURL` 또는 `webSocketFactory`로 설정한다.

> STOMP는 메시지 규약이고, STOMP.js는 클라이언트에서 그 규약을 지키도록 돕는 도구이다.

---

### ✅ SockJS란?

-   `SockJS`는 **WebSocket을 지원하지 않는 환경에서도 fallback을 통해 연결을 유지할 수 있게 해주는 라이브러리**다.
-   기본적으로 WebSocket을 시도하고, 안 되면 **XHR Polling 등 대체 방식**으로 통신을 유지한다.
    -   일부 브라우저나 프록시 환경에서 WebSocket이 막힐 수 있는데, SockJS는 자동으로 XHR 폴링 방식으로 대체해줌 → 연결 유지
-   보통 STOMP.js와 함께 사용하며, `webSocketFactory`에 SockJS 인스턴스를 넘겨준다.

> 정리하자면:  
> **STOMP.js는 메시징 로직**,  
> **SockJS는 네트워크 연결의 안정성**을 담당하는 역할을 한다.

---

### 🧪 사용 예시 (STOMP.js + SockJS)

```ts
import SockJS from 'sockjs-client';
import { Client } from '@stomp/stompjs';

const client = new Client({
    webSocketFactory: () => new SockJS('http://localhost:8080/ws'),
    onConnect: () => {
        client.subscribe('/topic/chat/room1', (message) => {
            console.log('받은 메시지:', message.body);
        });

        client.publish({
            destination: '/pub/chat/message',
            body: JSON.stringify({ content: 'Hello!' }),
        });
    },
});
client.activate();
```

### 스톰프는 어떤 계층에서 동작하나

### 스톱프와 웹소켓 다른점

###

### 참조

-   https://cloud.google.com/pubsub/docs/overview?hl=ko
-   https://kimpaul.tistory.com/33

# 공유회

### headless ui

### 외부로 노출되는 인터페이스

### 브레이킹 체인지

### 프롭스가 컴포넌트의 성격을 좌우한다

### 컴포넌트에게 props는 외부에 노출되는 인터페이스를 의미하며 이 인터페ㅔ이스는 가장 중요한 관리 대상이다.

### 상태나 횡단 관심사 추상화

### 비지니스의 의존성 덜기

### 관심사의 분리

### 변경이 잦는거와 변경이 없는거 분리하는게 그게 연습이 될거다, 내 비즈니스 로직이 ui 로직과 분리하는 연습이 좋을거다

### 모달

-   열리고 닫히고 밖으로 꺼내면?
-   비즈니스 로직과 열리고 닫히고가 연관됨
-   열리고 닫히고는 밖에ㅔ서 주입함
-   내 비즈니스 로직을 건드리는걸 최소한으로 노출하자

### render pro 패턴 비비즈니스 로직으로 표현 데이터로

### ui의 상태를 데이터로 추상화한다 데이터로 관리

### 좋은 코드 추천

-   https://tanstack.com/table/latest
-   https://tanstack.com/virtual/latest

### 꺠알 지식

-   bnf
-   지적우위
-   문맥 자유 문법
